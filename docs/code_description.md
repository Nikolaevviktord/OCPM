# Описание кода
## [`dijkstra.py`](https://github.com/Nikolaevviktord/OCPM/blob/master/dijkstra.py)
Данный файл необходим для генерации путей робота до точек на поле.

Далее - объяснение каждого раздела, каждой константы, каждой функции.

### Константы
 - `turn_left_func_name` - имя функции для поворота налево;
 -  `turn_right_func_name` - имя функции для поворота направо;
 - `go_to_n_cross_func_name` - имя функции для проезда до n-го перекрёстка

### Вывод и графическое окно
Подключается библиотека `sys`. Поток вывода программы переопределяется на файл `get_func_path.txt`.

Создаётся графическое окно и вспомогательный массив для работы с графикой.


### Методы (функции)
#### `get_weights() -> list[int]`
Функция для получения весов рёбер графа через графический интерфейс.

#### `parse_vertex(vertex: str) -> tuple[int]`
Вспомогательная функция, преобразовывающая вершину, заданную русской буквой от `а` до `ж`  (кроме `з`) и цифрой в кортеж вида `(x, y)` - координаты точки.

#### `vertex_to_str(x: int, y: int) -> str`
Функция, обратная `parse_vertex`.

#### `way(weight: list[int], finish: str) -> list[str]`
Функция, возвращающая кратчайший путь из точки старта (константа, `а3`) до точки `finish`. Веса ребёр заданы в массиве `weight` в следующей очерёдности: сначала горизонтальные рёбра сверху вниз и слева направо, потом вертикальные сверху вниз и слева направо.

##### `get_weight(x1: int, y1: int, x2: int, y2: int)` - длина ребра между вершинами `(x1, y1)` и `(x2, y2)`.

Далее реализуется стандартный алгоритм Дейкстры, на нём останавливаться не буду.

Возвращаемый массив содержит набор строк вида `БукваЦифра`, обозначающих вершины, по которым проходит маршрут.

#### `code(way: list[str]) -> list[int]`
Функция, преобразующая результат работы функции `way` в последовательность команд для робота. 

Синтаксис команд:

 - 0 - движение вперёд до перекрёстка
 - 1 - поворот направо
 - 2 - поворот налево

#### `get_code_to_vertex(weight: list[int], finish: str)`
`code(way(weight, finish))`

### Основной код
Переменные:

 - `rows` - строки поля;
 - `cols` - столбцы поля;
 - `weights` - результат работы функции `get_weights` (веса рёбер, введённые пользователем).

Далее следует основной цикл, выводящий последовательность инструкций для каждой финальной вершины.

## [`arduino_sketch.ino`](https://github.com/Nikolaevviktord/OCPM/blob/master/arduino_sketch.ino)
Данный файл является кодом микроконтроллера Arduino для выполнения задания.

Далее - объяснение каждого раздела, каждой константы, каждой функции.

### Константы
 - `L_DIR` и `L_POW` - пины, отвечающие за направление и скорость левого мотора, соответственно;
 - `R_DIR` и `R_POW` - пины, отвечающие за направление и скорость правого мотора, соответственно;
 - `R_LINE` - пин, на который подключен правый датчик линии;
 - `L_LINE` - пин, на который подключен левый датчик линии;
 - `gray` - значение границы белого и черного цвета;
 - `L_coef` - коэффициент скорости левого мотора;
 - `R_coef` - коэффициент скорости правого мотора;
 - `M_coef` - средний коэффициент между коэффициентами скорости левого и правого моторов (коэффициент скорости середины колёсной базы).

### `setup()`
Основная функция.

Объявляет входы и выходы платы.

Вызывает функцию считывания штрих-кода (она далее).

Вызывает функцию движения до необходимой точки (она далее).

После выполнения задания останавливает робота.

### Функции датчиков линии
#### `int left_line()`
Возвращает аналоговое значение левого датчика линии.

#### `int right_line()`
Возвращает аналоговое значение правого датчика линии.

#### `bool l_line()`
Возвращает преобразованное значение левого датчика линии, где `true` - датчик на белом, `false` - датчик на чёрном.

#### `bool r_line()`
Возвращает преобразованное значение правого датчика линии, где `true` - датчик на белом, `false` - датчик на чёрном.

### Функции движения
#### `void setMotors(int L, int R)`
`L` и `R` принимают значения от `-255` до `255`, где отрицательные значения - мотор вращается назад со скоростью равной модулю аргумента, нуль - мотор отключён, положительные значения - мотор вращается вперёд со скоростью равной аргументу.

#### `void faststop()`
Функция резкой остановки робота.

#### `void go_zigzag_to_cross()`
Проезд регулятором "зигзаг" до ближайшего перекрёстка.

#### `void zigzag_to_n_cross(int n)`
Проезд регулятором "зигзаг" до n-го перекрёстка.

#### 	`void turn_left()`
Поворот налево по датчикам линии.

#### 	`void turn_right()`
Поворот направо по датчикам линии.

### `byte barcode()`
Чтение штрих-кода. Робот едет вперёд на протяжении определённого количества времени и записывает моменты изменения цвета полос под ним. После этого, калибровочные значения усредняются, высчитываются итоговые значения.

Возвращается десятичная запись числа.

### Результат выполнения `./dijkstra.py`
Сюда вставить результат исполнения второго файла.

### Пустая `loop`-функция
Пустая `loop`-функция.
